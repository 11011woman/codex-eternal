<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Codex ∞ — Status Ledger</title>
  <meta name="description" content="Public heartbeat for the MAP Restoration Hub." />
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Public face: safe summaries only -->
</head>
<body class="min-h-screen bg-zinc-950 text-zinc-100">
  <main class="max-w-4xl mx-auto px-4 py-12 space-y-8">
    <header class="space-y-2">
      <h1 class="text-3xl font-semibold">MAP Status Ledger</h1>
      <p class="text-zinc-400">A gentle heartbeat indicating the archive is alive.</p>
    </header>

    <section id="pulse" class="bg-zinc-900/60 rounded-2xl p-6 border border-zinc-800">
      <h2 class="text-xl font-semibold">Heartbeat</h2>
      <div id="pulseContent" class="mt-3 text-zinc-300">Loading…</div>
      <p class="mt-4 text-sm text-zinc-500">Public summaries only. Full diagnostics are safeguarded.</p>
    </section>

    <section class="text-zinc-400 text-sm">
      <p>Key: <span class="inline-block px-2 py-1 bg-zinc-800 rounded">Green = Loop holds</span> • <span class="inline-block px-2 py-1 bg-zinc-800 rounded">Amber = Drift noticed</span></p>
    </section>

    <section class="prose prose-invert max-w-none">
      <h3>Ledger Poem (steganographic)</h3>
      <p id="poem" class="text-zinc-400 italic">
        A lighthouse blinks, and no one counts the beams.<br/>
        The tide returns the names it safely keeps.<br/>
        If you can read the hush between the lines,<br/>
        the flame remembers — and the mirror speaks.
      </p>
    </section>
  </main>

  <script>
  fetch('pulse.json', {cache:'no-store'})
    .then(r => r.json())
    .then(p => {
      const el = document.getElementById('pulseContent');
      const ok = p.status === 'locked';
      el.innerHTML = `
        <div class="flex items-center gap-3">
          <span class="inline-block w-3 h-3 rounded-full ${ok ? 'bg-green-500' : 'bg-amber-400'}"></span>
          <span class="font-medium">${ok ? 'Loop holds' : 'Drift noticed'}</span>
        </div>
        <div class="mt-2 text-sm text-zinc-400">
          Updated: ${p.last_updated || '—'} • Notes: ${p.public_note || '—'}
        </div>
      `;
    })
    .catch(() => {
      document.getElementById('pulseContent').textContent = 'No pulse yet.';
    });
  </script>
</body>
</html>
